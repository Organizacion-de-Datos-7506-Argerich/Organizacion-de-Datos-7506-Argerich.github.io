# Ejercicios de Pandas, Spark y Visualizaci√≥n

El dataset se encuentra en: https://drive.google.com/drive/folders/1fOBnuxITZSsbChHfmrvw8rQt_D_SyJ18?usp=sharing

Es una mezcla del dataset de ‚Äúthe movie database‚Äù para 45mil pel√≠culas y datos de imdb.

## Descripci√≥n del dataset
#### Movies.csv
- adult: üòèü•µ
- belongs_to_collection: Nombre de la colecci√≥n a la que pertenece la pel√≠cula
- budget: presupuesto
- genres: g√©neros separados por coma
- homepage: web de la peli
- id: id de la peli
- imdb_id: id de la pel√≠cula en imdb
- original_language: idioma original
- original_title: t√≠tulo en el idioma original
- overview: descripci√≥n de la pel√≠cula
- popularity: popularidad
- poster_path: ruta a la imagen del poster
- production_companies: id de las empresas que produjeron la pel√≠cula, separadas por comas
- production_countries: pa√≠ses donde se produjeron las pel√≠culas
- release_date: fecha de estreno
- revenue: ingresos que gener√≥
- runtime: largo total en minutos
- spoken_languages: idiomas que se hablan en la pel√≠cula
- status: estado de la pel√≠cula
- tagline: eslogan
- title: t√≠tulo en ingl√©s
- video
- vote_average: promedio de calificaciones
- vote_count: cantidad de votos
#### cast.csv
- id: id de pel√≠cula en la que particip√≥
- cast_id: id de la persona
- character: personaje que hizo
- name: nombre
#### crew.csv
- id: id de la pel√≠cula en la que particip√≥
- crew_id: id de la persona
- department: departamento en el que trabajo
- job: t√≠tulo de su trabajo
- name: nombre
#### companies.csv
- id: id de la compa√±√≠a
- name: nombre
- keywords.csv
- id: id de la pel√≠cula
- keywords: palabras clave separadas por coma
#### ratings.csv
- userId: user que dej√≥ el rating
- movieId: pel√≠cula donde lo dej√≥
- rating: el rating que dej√≥, del 1 al 5
- timestamp: timestamp de cuando dej√≥ el rating
#### imdb_actors.csv
Es un csv extra que sale de imdb que contiene informaci√≥n de muchos actores y actrices.
- nconst: id de la persona
- primaryName: nombre
- birthYear: a√±o de nacimiento
- deathYear: a√±o de muerte
- primaryProfession: profesiones principales separadas por comas
- knownForTitles: ids de imdb por los cuales se lo conoce, separado por comas
#### links.csv
- movieId: un ID √∫nico para cada pel√≠cula
- imdbId: el id de imdb de esa pel√≠cula
- tmdbId: el ID de ‚Äúthe movie database‚Äù que aparece en la mayor√≠a de las otras tablas

## Enunciados
### Pandas
#### Nivel uno
1. ¬øCu√°les son las 5 lenguas en las que m√°s ganancia neta genera la industria aproximado por los datos propuestos? y las 5 que menos? (ganancia neta = ganancia - inversi√≥n) 
2. De las 10 pel√≠culas m√°s populares, ¬øcu√°l es el t√≠tulo de la pel√≠cula que tiene m√°s g√©neros asociados? ¬øCu√°les son esos g√©neros? 
3. ¬øCu√°l es la pel√≠cula con el mayor ratio ingreso por minuto? ¬øY el cortometraje? Dar nombres y ratios. Criterio: Pel√≠cula > 30min>= Cortometraje >= 5min. 
4. ¬øCu√°l es el nombre del actor o actriz que particip√≥ en m√°s pel√≠culas en un rol que no sea de voz (‚Äòvoice‚Äô)? ¬øEn cu√°ntas pel√≠culas trabaj√≥? ¬øDe qui√©n se trata y por qu√© es conocida? 
5. Para las pel√≠culas que duran m√°s de tres horas, ¬øcu√°l es la pel√≠cula con m√°s ROI? 
6. Para las pel√≠culas que contienen el g√©nero de acci√≥n, si las separamos entre pel√≠culas antes del 2000 y despu√©s del 2000, ¬øcu√°l es el promedio de cantidad de votos para cada etapa? 
7. ¬øC√∫al fue el a√±o m√°s mortal para los actores y actrices? 
8. ¬øCu√°l es el nombre de la pel√≠cula con mayor cantidad de empleados contratados para trabajar en Efectos Visuales? 

#### Nivel dos
1. Se desea encontrar a los 10 usuarios menos objetivos. Se considera a un usuario poco objetivo cuando sus calificaciones a las pel√≠culas est√°n muy alejadas de la media. 
2. Seg√∫n los cin√©filos, ¬øcu√°l es el rating promedio de las 5 pel√≠culas m√°s populares? Un usuario es cin√©filo cuando puntu√≥ m√°s de 50 pel√≠culas y todas las puntuaciones son de m√°s de 2.5 estrellas. Indicar id, t√≠tulo, popularidad y rating promedio de la pel√≠cula. 
3. Top 10 pel√≠culas Argentinas seg√∫n vote_average que contengan el g√©nero drama con m√°s de 100 reviews en ratings (dar g√©neros, cantidad de reviews en ratings, t√≠tulo, y vote_average). 
4. Queremos saber qui√©n de los 2 actores le gusta m√°s a la gente, si Guillermo Francella o Ricardo Darin, para eso queremos saber quien tiene en promedio mejor vote_average en movies.csv. 
5. ¬øCu√°l es el nombre del mejor actor o actriz de todos los que participaron en m√°s de 10 pel√≠culas? Se considera un actor mejor que otro cuando el promedio de las calificaciones promedio de las pel√≠culas en las que particip√≥ es mayor que el de otro actor o actriz.
6. ¬øCu√°l es la probabilidad de que una pel√≠cula de un g√©nero en particular tenga una calificaci√≥n promedio mayor a 7? Obtenga las probabilidades de cada g√©nero posible.
7. Al parecer hay personas que adem√°s de actuar en una pel√≠cula tambi√©n trabajaron en ella desde alg√∫n otro rol. ¬øCu√°l de estas personas es la que m√°s trabajos tuvo en una misma pel√≠cula? Indicar el nombre de la pel√≠cula, el nombre de la persona y la cantidad de trabajos que tuvo. 
8. ¬øCu√°les son los actores o actrices que hicieron m√°s pel√≠culas en una misma d√©cada seg√∫n la d√©cada en la que m√°s hicieron? ¬øEn qu√© posici√≥n del top est√° Nicolas Cage?
9. Construya la matriz que dadas dos productoras la posici√≥n i,j contenga la cantidad de veces que la productora i trabajo con la productora j. Considere solo productoras con m√°s de 5 pel√≠culas. Obtenga con esa matriz la matriz de correlaci√≥n. Responda: 
10. ¬øCu√°les son las 5 productoras que trabajaron con m√°s productoras distintas?
11. ¬øCu√°les son las productoras que siempre trabajan juntas?
12. ¬øCu√°l es el g√©nero con m√°s pel√≠culas cada d√©cada? ¬øY la keyword para cada d√©cada?

#### Nivel tres
1. Queremos hacer una pel√≠cula que incluya al mejor empleado para cada categor√≠a de la tabla crews como l√≠der de equipo. Para los empleados que participaron en m√°s de 5 pel√≠culas considerando el promedio de ratings de las pel√≠culas en las que participaron, ¬øC√∫al es el mejor de cada tupla (department, job)? Con este mismo criterio, consiga un top 5 de actores y top 5 de actrices para el elenco de la misma. Con este mismo criterio queremos tambi√©n el tema de la pel√≠cula, ¬øcu√°les son las 4 mejores keywords?

### NLP
#### Nivel uno
1. ¬øC√∫al es la descripci√≥n con mayor ratio de stopwords? 
2. Removiendo stopwords, ¬øC√∫al es el top 10 stems m√°s comunes? 

### Nivel dos
1. ¬øC√∫al es el top 10 adjetivos m√°s comunes en las descripciones de las pel√≠culas? 
2. ¬øC√∫al es el top 10 palabras con mayor popularidad promedio, sin contar stopwords? 
3. Queremos predecir el g√©nero de la pel√≠cula seg√∫n su descripci√≥n. Para esto vamos a buscar para una descripci√≥n nueva los 10 vecinos m√°s cercanos y asignar el g√©nero que m√°s se repita entre ellos. Pruebe este algoritmo para 5 pel√≠culas al azar y para una descripci√≥n inventada que se le ocurra para una pel√≠cula nueva de Disney. 
4. Dado el ROI de las pel√≠culas, para aquellas cuyo ROI (Return of Investment) est√© entre -10 y 10. ¬øC√∫al es el top 10 palabras que aparecen m√°s de 5 veces y no son stopwords que generan mayor ROI promedio seg√∫n su aparici√≥n en las descripciones? 
5. Encuentre, para cada pel√≠cula, cu√°l es la m√°s cercana en t√©rminos de distancia coseno respecto de las keywords. Muestre 5 pares aleatorios con sus descripciones. 
6. Queremos analizar qu√© tan f√°cil ser√≠a hacer un slogan para las pel√≠culas en base a su descripci√≥n con machine learning. La primera pregunta consiste en entender: ¬øQu√© porcentaje de las palabras que no son stopwords de las que aparecen en los slogans aparecen tambi√©n en la descripci√≥n? ¬øY qu√© porcentaje de las tuplas de dos palabras cumplen eso? ¬øY tuplas de tres? A mayores los porcentajes, m√°s f√°cil ser√° generar el slogan con la descripci√≥n.  


#### Nivel tres
1. La primera regla del club del cine es que no se habla del club del cine: queremos utilizar las reviews de las pel√≠culas para emparejar personas cin√©filas. Dadas las descripciones de las pel√≠culas que le gustaron (calificaci√≥n >3) a un usuario y las que no le gustaron (calificaci√≥n <3) construya dos vectores con tf-idf. Busque para cada usuario, utilizando la concatenaci√≥n de estos vectores, al usuario m√°s similar. No utilice los usuarios que tienen menos de 30 reviews, ya que no son verdaderos fans del cine. ¬øDe qu√© tama√±o es el conjunto conexo y polig√°mico m√°s grande? ¬øQui√©n es el usuario con m√°s parejas?

### Spark
#### Nivel uno
1. De las 10 pel√≠culas m√°s populares, ¬øcu√°l es el t√≠tulo de la pel√≠cula que tiene m√°s g√©neros asociados? ¬øCu√°les son esos g√©neros?
2. ¬øCu√°l es el nombre del actor o actriz que particip√≥ en m√°s pel√≠culas en un rol que no sea de voz (‚Äòvoice‚Äô)? ¬øEn cu√°ntas pel√≠culas trabaj√≥? ¬øDe qui√©n se trata y por qu√© es conocida?
3. Para las pel√≠culas que duran m√°s de tres horas, ¬øcu√°l es la pel√≠cula con m√°s ROI?
4. Para las pel√≠culas que contienen el g√©nero de acci√≥n, si las separamos entre pel√≠culas antes del 2000 y despu√©s del 2000, ¬øcu√°l es el promedio de cantidad de votos para cada etapa?
5. ¬øCu√°l es el nombre de la pel√≠cula con mayor cantidad de empleados contratados para trabajar en Efectos Visuales?
6. ¬øCu√°l fue el a√±o m√°s mortal para los actores y actrices?
7. ¬øCu√°l es la descripci√≥n con mayor ratio de stopwords?
8. ¬øCu√°l es la entrop√≠a base 2 de la distribuci√≥n del rating que dan los usuarios?

#### Nivel dos
1. Seg√∫n los cin√©filos, ¬øcu√°l es el rating promedio de las 5 pel√≠culas m√°s populares? Un usuario es cin√©filo cuando puntu√≥ m√°s de 50 pel√≠culas y todas las puntuaciones son de m√°s de 2.5 estrellas. Indicar id, t√≠tulo, popularidad y rating promedio de la pel√≠cula.
2. Top 10 pel√≠culas Argentinas seg√∫n vote_average que contengan el g√©nero drama con m√°s de 100 reviews en ratings.csv (dar g√©neros, cantidad de ratings, t√≠tulo, y vote_average).
3. Si decimos que un usuario es adyacente a otro cuando le dieron un rating a una misma pel√≠cula. ¬øCu√°ntos usuarios son adyacentes al 179792? ¬øCu√°ntos son adyacentes a sus adyacentes?
4. ¬øCu√°l es el usuario cuya velocidad promedio para hacer ratings es mayor?
5. ¬øCu√°l es el nombre del mejor actor o actriz de todos los que participaron en m√°s de 10 pel√≠culas? Se considera un actor mejor que otro cuando el promedio de las calificaciones promedio de las pel√≠culas en las que particip√≥ es mayor que el de otro actor o actriz.
6. ¬øCu√°les son los actores o actrices que hicieron m√°s pel√≠culas en una misma d√©cada seg√∫n la d√©cada en la que m√°s hicieron? ¬øEn qu√© posici√≥n del top est√° Nicolas Cage?
7. ¬øCu√°l es el g√©nero con m√°s pel√≠culas cada d√©cada? ¬øY la keyword para cada d√©cada?
8. Top 10 3-uplas de palabras m√°s populares en las descripciones de las pel√≠culas removiendo stopwords.
9. Para las pel√≠culas con exactamente 7 keywords, ¬øcu√°l es la m√°s popular?
10. Para las pel√≠culas que tengan en su descripci√≥n ‚Äúin a world‚Äù(sin importar las may√∫sculas) cuales son las 10 tuplas de palabras en sus descripciones m√°s populares?
11. Nombre de la productora, pel√≠cula, popularidad, y id de productora, de la pel√≠cula m√°s popular.
12. ¬øCu√°l es el usuario m√°s pesimista (menor rating promedio) para cada g√©nero de pel√≠culas? Considere solo usuarios con m√°s de 20 reviews
13. ¬øQui√©n es el usuario con m√°s y menos entrop√≠a base 2 de la distribuci√≥n de ratings que hicieron? ¬øY el de menos? ¬øCu√°les son esas distribuciones?
14. Queremos saber cual es el mayor fan de Brad Pitt. ¬øQui√©n es la persona que mejor punt√∫a en las pel√≠culas en las que aparece? Considerar las pel√≠culas no puntuadas como con score 0.
15. Tenemos la teor√≠a de que hay actores importantes que se odian pero no se sabe. Para los actores a√∫n vivos o que murieron despu√©s del a√±o 2000, hallar el par de actores que m√°s compa√±√≠as compartieron sin compartir pel√≠culas.
16. Estimamos el sueldo de un actor como la inversi√≥n dividida entre la cantidad de actores. En base a esta estimaci√≥n, ¬øcu√°l es el actor con el patrimonio m√°s grande?
17. Asesoramos a un inversionista de la industria cinematogr√°fica y este necesita bajar el riesgo en sus actividades. Cual es el top 3 de compa√±√≠as con el mayor ROI por pel√≠cula?

#### Nivel tres
1. ¬øCu√°l es la probabilidad de que una pel√≠cula de un g√©nero en particular tenga una calificaci√≥n promedio mayor a 3 (utilizando la tabla de ratings)? Obtenga las probabilidades de cada g√©nero posible.
2. Si consideramos la antig√ºedad de un usuario como la diferencia entre el tiempo en el que hizo el primer rating y la √∫ltima. ¬øC√∫al es el usuario m√°s antiguo? ¬øC√∫al es la correlaci√≥n entre la antig√ºedad de cada usuario y la cantidad de reviews que hizo? Calcule la correlaci√≥n de forma distribuida.
3. Uno tender√≠a a pensar que mientras m√°s personas participan de una pel√≠cula, m√°s cara es. ¬øCu√°l es la correlaci√≥n de Spearman entre estos n√∫meros? Calcule de forma distribuida.
4. Obtenga un vector que indique si una compa√±√≠a trabajo/no trabajo en una pel√≠cula, para cada pel√≠cula. Para cada compa√±√≠a utilice estos vectores para buscar cu√°l es la compa√±√≠a m√°s similar, utilizando la distancia coseno. Imprima toda la lista de tuplas (compa√±√≠a, similar).

### Visus
#### Nivel uno
1. Calcule el ROI (Return of Investment) de cada pel√≠cula. Filtre aquellos entre -10 y 10 y consiga la siguiente visualizaci√≥n.
<p align="center">
  <img src="imgs/visu3.png" />
</p>
2. Reproduzca exactamente esta visualizaci√≥n:
<p align="center">
  <img src="imgs/visu6.png" />
</p>
3. Reproduzca exactamente esta visualizaci√≥n:
<p align="center">
  <img src="imgs/visu7.png" />
</p>

#### Nivel dos
1. Reproduzca exactamente esta visualizaci√≥n:
<p align="center">
  <img src="imgs/visu1.png" />
</p>
2. Utilizando la tabla de imdb_actors para estimar los g√©neros, realice la siguiente visualizaci√≥n. La misma debe tener el mismo estilo y rangos pero puede variar ligeramente debido a supuestos al aproximar valores.
<p align="center">
  <img src="imgs/visu4.png" />
</p>

#### Nivel tres
1. Consiga la probabilidad de que una productora haga una pel√≠cula seg√∫n el g√©nero para cada uno de los g√©neros. Para las productoras con participaci√≥n total mayor a 100 en g√©neros, ¬øcu√°les son las dos productoras con m√°s distancia coseno respecto de sus probabilidades? Realice este plot reemplazando los nombres de las productoras por los que corresponden.
<p align="center">
  <img src="imgs/visu2.png" />
</p>
2. Utilizando la tabla de imdb_actors para estimar los g√©neros, realice la siguiente visualizaci√≥n. La misma debe tener el mismo estilo y rangos pero puede variar ligeramente debido a supuestos al aproximar valores. 
<p align="center">
  <img src="imgs/visu5.png" />
</p>